<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">

<!--
`uvalib-search-box`
Library Search Box

@demo demo/index.html
-->

<dom-module id="uvalib-search-box">
  <template>
    <style is="custom-style">
      :host {
        display: block;
        font-family: var(--uvalib-search-box-font-family,--font-primary);
        --paper-input-container-input {
          background: var(--color-white);
        }
      }
      paper-input {
        --paper-input-container-input-color: var(--uvalib-search-box-selected-tab-text-color,--color-white);
        --paper-input-container-color: var(--uvalib-search-box-tab-color,--color-medium-gray);
        --paper-input-container-focus-color: var(--uvalib-search-box-tab-color,--color-medium-gray);
      }
      paper-tabs {
        width: 40%;
        background-color: var(--uvalib-search-box-tab-color,--color-light-blue);
        color: var(--uvalib-search-box-tab-text-color,--color-primary-blue);
      }
      iron-pages {
        background-color: var(--uvalib-search-box-bkgrd-color,--color-primary-blue);
        margin-left: auto;
        margin-right: auto;
        padding-top: 65px;
        padding-bottom: 30px;
      }
      paper-button {
        background-color: var(--uvalib-search-box-btn-bkgrd-color,--color-light-blue);
        color: var(--uvalib-search-box-btn-text-color,--color-secondary-blue);
        line-height: 24px;
      }
      paper-tab.iron-selected {
        background-color: var(--uvalib-search-box-selected-tab-color,--color-primary-blue);
        color: var(--uvalib-search-box-selected-tab-text-color,--color-white);
      }
      .advancedSearch {
        padding-top: 10px;
        padding-bottom: 25px;
      }
      .searchLink {
        float: left;
        padding-right: 20px;
      }
      .searchLink a {
        color: var(--uvalib-search-box-selected-tab-text-color,--color-white);
      }
    </style>
    <div class="">
      <paper-tabs selected="{{selectedTab}}" no-bar no-slide>
        <paper-tab>{{virgoSearchTabText}}</paper-tab>
        <template is="dom-if" if="{{siteSearch}}">
          <paper-tab>{{siteSearchTabText}}</paper-tab>
        </template>
      </paper-tabs>
      <iron-pages selected="{{selectedTab}}">
        <div id="virgo">
          <form is="iron-form" method="get" action="{{virgoSearchTabUrl}}" id="virgoSearchForm">
            <input type="hidden" name="portal" value="all">
            <input type="hidden" name="catalog_select" value="all">
            <input type="hidden" name="sort" value="date_received_facet desc">
            <paper-input id="q" name="q" label="" placeholder="{{searchVirgoPlaceholder}}"><paper-button suffix onclick="submitCatalogSearch()">Search</paper-button></paper-input>
          </form>
          <div class="advancedSearch">
            <template is="dom-if" if="{{_advancedSearch}}">
              <template is="dom-if" if="{{advancedCatalogSearch}}">
                <div class="searchLink">
                  <a href="{{advancedCatalogSearchUrl}}">{{advancedCatalogSearchText}}</a>
                </div>
              </template>
              <template is="dom-if" if="{{advancedArticleSearch}}">
                <div class="searchLink">
                  <a href="{{advancedArticleSearchUrl}}">{{advancedArticleSearchText}}</a>
                </div>
              </template>
            </template>
          </div>
        </div>

        <div id="site">
          <form is="iron-form" method="get" action="{{siteSearchTabUrl}}" id="siteSearchForm">
            <paper-input id="s" name="s" label="" placeholder="{{searchSitePlaceholder}}"><paper-button suffix onclick="submitSiteSearch()">Search</paper-button></paper-input>
          </form>
        </div>
      </iron-pages>
    </div>
  </template>

  <script>
    Polymer({

      is: 'uvalib-search-box',

      properties: {
        /**
         * Indicates whether to display advanced article search link
         */
        advancedArticleSearch: {
          type: Boolean,
          value: false
        },

        /**
         * Text to display for article search hyperlink.
         */
        advancedArticleSearchText: {
          type: String,
          value: 'Article Advanced Search'
        },

        /**
         * URL for accessing the advanced article search features.
         */
        advancedArticleSearchUrl: {
          type: String,
          value: '//search.lib.virginia.edu/articles/advanced?catalog_select=articles'
        },

        /**
         * Indicates whether to display advanced catalog search link
         */
        advancedCatalogSearch: {
          type: Boolean,
          value: false
        },

        /**
         * Text to display for catalog search hyperlink.
         */
        advancedCatalogSearchText: {
          type: String,
          value: 'Catalog Advanced Search'
        },

        /**
         * URL for accessing the advanced catalog search features.
         */
        advancedCatalogSearchUrl: {
          type: String,
          value: '//search.lib.virginia.edu/advanced?catalog_select=catalog'
          },

        /**
         * Indicates if any advanced search option should be displayed.
         */
        _advancedSearch: {
          type: Boolean,
          computed: '_either(advancedCatalogSearch,advancedArticleSearch)'
        },

        /**
         * Placeholder text to display in the Virgo search input text box.
         */
        searchVirgoPlaceholder: {
          type: String,
          value: 'Search Virgo for books, articles, digital materials, and more.',
        },

        /**
         * Placeholder text to display in the site search input text box.
         */
        searchSitePlaceholder: {
          type: String,
          value: 'Search the UVA Library website.',
        },

        /**
         * Tab selected for display.
         */
        selectedTab: {
          type: String,
          value: '0'
        },

        /**
         * Indicates whether to display site search tab.
         */
        siteSearch: {
          type: Boolean,
          value: false
        },

        /**
         * Text to display in site search tab.
         */
        siteSearchTabText: {
          type: String,
          value: 'Site Search',
        },

        /**
         * URL used to search the site.
         */
        siteSearchTabUrl: {
          type: String,
          value: '//www.library.virginia.edu/',
        },

        /**
         * Text to display in Virgo search tab.
         */
        virgoSearchTabText: {
          type: String,
          value: 'Virgo'
        },

        /**
         * URL used to search Virgo.
         */
        virgoSearchTabUrl: {
          type: String,
          value: '//search.lib.virginia.edu/catalog'
        },
      },

      /**
       * Returns the boolean result for **a OR b**.
       *
       * @param {Boolean} a
       * @param {Boolean} a
       */
      _either: function(a,b) {
        return (a || b);
      },

    });

    /**
     * Submits the Virgo search form.
     */
    function submitCatalogSearch() {
      document.getElementById('virgoSearchForm').submit();
    };

    /**
     * Submits the Library site search form.
     */
    function submitSiteSearch() {
      document.getElementById('siteSearchForm').submit();
    };

  </script>
</dom-module>
